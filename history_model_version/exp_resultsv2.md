# DynamicGraphMixer v2 Experiment Results (exp_resultsv2.md)

## Purpose
- Track v2 experiments defined in `implementationTODOv2.md`.
- Keep results reproducible with configs, seeds, and log paths.
- Record both metrics (MSE/MAE) and graph diagnostics.

## Logging conventions
- Command template (example):
  - `python run.py ... --graph_log_interval N --graph_log_exp_id <id>`
- Graph stats output:
  - `graph_logs/<exp_id>/stats.csv`
  - `graph_logs/<exp_id>/epochXXX_stepYYYYY/adj_heatmap_segK.png`
- Results output:
  - `results/<setting>/metrics.npy`
  - `result_long_term_forecast.txt` (append)
- Stats fields (high-level):
  - post: entropy/topk_mass/topk_overlap/adj_diff/diag/offdiag
  - raw: entropy/topk_mass/topk_overlap/adj_diff + conf stats
  - conf: conf_mean/std/p10/p50/p90
  - gate/alpha: mean/std/quantiles/saturation
  - base: entropy/topk_mass/diag/offdiag

## v2.0 - Baseline freeze + observability

### Code tasks
- [ ] Log adj_raw entropy/topk_mass/topk_overlap pre-sparsify
- [ ] Log adj entropy/topk_mass/topk_overlap post-sparsify
- [ ] Log adj_diff mean(|A_t - A_{t-1}|)
- [ ] Log conf stats from raw entropy
- [ ] Log gate and alpha stats (mean/std/quantiles/saturation)
- [ ] Log base graph entropy/topk_mass/diag/offdiag (if enabled)
- [ ] Save stats to `graph_logs/<exp_id>/stats.csv`

### Experiments
| Exp ID | Run ID | Config or Args | Metrics (MSE/MAE) | Adj stats (post) | Adj stats (raw) | Conf stats | Gate stats | Alpha stats | Base stats | Artifacts | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| E0-1 | DynamicGraphMixer_TCN_ETTm1_96_96 | `python -u run.py --task_name long_term_forecast --is_training 1 --model_id DynamicGraphMixer_TCN_ETTm1_96_96 --model DynamicGraphMixer --data ETTm1 --root_path ./datasets --data_path ETTm1.csv --features M --target OT --freq t --seq_len 96 --label_len 48 --pred_len 96 --e_layers 2 --d_model 128 --d_ff 256 --enc_in 7 --dec_in 7 --c_out 7 --batch_size 64 --train_epochs 15 --patience 3 --use_norm 1 --graph_scale 4 --graph_rank 8 --graph_smooth_lambda 0 --temporal_encoder tcn --tcn_kernel 3 --tcn_dilation 2 --graph_log_interval 200 --graph_log_topk 5 --graph_log_num_segments 2 --graph_log_dir ./graph_logs --graph_log_exp_id E0-1 --graph_source content_mean --stable_level point --stable_feat_type detrend --stable_window 16 --graph_base_mode mix --graph_base_alpha_init -8 --graph_base_l1 0.001 --gate_mode scalar --gate_init -4 --adj_sparsify topk --adj_topk 4` | mse:0.33411359786987305, mae:0.3708299994468689 | ent=1.0821, topk=1.000, overlap=0.9200, l1=0.1118, mean=0.1429, var=0.0386, max=0.9754, diag=0.0930, off=0.1512 | raw_ent=1.4077, raw_topk=0.9058, raw_overlap=0.9030, raw_l1=0.0866, raw_mean=0.1429, raw_var=0.0289, raw_max=0.9691, raw_diag=0.1024, raw_off=0.1496 | conf_mean=0.2766, conf_std=0.2507, p10=0.0206, p50=0.2014, p90=0.6773 | gate_mean=0.01876, std=0.00000, p10=0.01876, p50=0.01876, p90=0.01876, sat_low=1.00, sat_high=0.00 | alpha_mean=0.000304, std=0.000000, p10=0.000304, p50=0.000304, p90=0.000304, sat_low=1.00, sat_high=0.00 | base_ent=1.9458, base_topk=0.7193, base_diag=0.1433, base_off=0.1428 | graph_logs/E0-1/stats.csv | baseline M8-4 (ETTm1 96->96) |


### Summary
- Result: M8-4 baseline run (ETTm1 96->96) mse=0.33437901735305786, mae=0.37103986740112305
- Decision:

---

## v2.1 - Static gate sweep (no structural change)

### Experiments
| Exp ID | Run ID | Config or Args | Metrics (MSE/MAE) | Adj stats (post) | Adj stats (raw) | Conf stats | Gate stats | Alpha stats | Base stats | Artifacts | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| E1-A | DynamicGraphMixer_TCN_ETTm1_96_96_E1A_none | gate_mode=none, gate_init=-4 |  | ent=1.4945, topk=0.9631, overlap=0.9016, l1=0.0778, mean=0.1429, var=0.0169, max=0.9888, diag=0.1956, off=0.1341 | raw_ent=1.5368, raw_topk=0.9489, raw_overlap=0.9016, raw_l1=0.0750, raw_mean=0.1429, raw_var=0.0161, raw_max=0.9887, raw_diag=0.1942, raw_off=0.1343 | conf_mean=0.2102, conf_std=0.1351, p10=0.0629, p50=0.1872, p90=0.3880 | gate=none | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9427, base_topk=0.7368, base_diag=0.1529, base_off=0.1412 | `graph_logs/v2_1_E1-A_gate_none/stats.csv` | last log step |
| E1-A | DynamicGraphMixer_TCN_ETTm1_96_96_E1A_scalar | gate_mode=scalar, gate_init=-4 |  | ent=1.3143, topk=0.9487, overlap=0.8912, l1=0.1098, mean=0.1429, var=0.0314, max=0.9998, diag=0.0995, off=0.1501 | raw_ent=1.3924, raw_topk=0.9143, raw_overlap=0.8912, raw_l1=0.1022, raw_mean=0.1429, raw_var=0.0295, raw_max=0.9997, raw_diag=0.0988, raw_off=0.1502 | conf_mean=0.2845, conf_std=0.2668, p10=0.0191, p50=0.1983, p90=0.7039 | gate_mean=0.01882, std=0.00000, p10=0.01882, p50=0.01882, p90=0.01882, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00030, std=0.00000, p10=0.00030, p50=0.00030, p90=0.00030, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7235, base_diag=0.1430, base_off=0.1428 | `graph_logs/v2_1_E1-A_gate_scalar/stats.csv` | last log step |
| E1-A | DynamicGraphMixer_TCN_ETTm1_96_96_E1A_per_var | gate_mode=per_var, gate_init=-4 |  | ent=1.3264, topk=0.9490, overlap=0.8922, l1=0.1049, mean=0.1429, var=0.0306, max=0.9998, diag=0.0990, off=0.1502 | raw_ent=1.4040, raw_topk=0.9148, raw_overlap=0.8922, raw_l1=0.0975, raw_mean=0.1429, raw_var=0.0287, raw_max=0.9997, raw_diag=0.0974, raw_off=0.1504 | conf_mean=0.2785, conf_std=0.2615, p10=0.0188, p50=0.1958, p90=0.6899 | gate_mean=0.01812, std=0.00095, p10=0.01711, p50=0.01806, p90=0.01904, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00030, std=0.00000, p10=0.00030, p50=0.00030, p90=0.00030, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7235, base_diag=0.1430, base_off=0.1428 | `graph_logs/v2_1_E1-A_gate_per_var/stats.csv` | last log step |
| E1-A | DynamicGraphMixer_TCN_ETTm1_96_96_E1A_per_token | gate_mode=per_token, gate_init=-4 |  | ent=1.3346, topk=0.9464, overlap=0.8894, l1=0.1056, mean=0.1429, var=0.0302, max=0.9998, diag=0.0976, off=0.1504 | raw_ent=1.4153, raw_topk=0.9103, raw_overlap=0.8894, raw_l1=0.0977, raw_mean=0.1429, raw_var=0.0282, raw_max=0.9997, raw_diag=0.0971, raw_off=0.1505 | conf_mean=0.2727, conf_std=0.2648, p10=0.0172, p50=0.1807, p90=0.6879 | gate_mean=0.01804, std=0.00080, p10=0.01712, p50=0.01791, p90=0.01924, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00030, std=0.00000, p10=0.00030, p50=0.00030, p90=0.00030, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7235, base_diag=0.1430, base_off=0.1428 | `graph_logs/v2_1_E1-A_gate_per_token/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_none_init-8 | gate_mode=none, gate_init=-8 | mse:0.36005261540412903, mae:0.40020933747291565 | ent=1.4941, topk=0.9632, overlap=0.9017, l1=0.0778, mean=0.1429, var=0.0169, max=0.9882, diag=0.1953, off=0.1341 | raw_ent=1.5365, raw_topk=0.9488, raw_overlap=0.9017, raw_l1=0.0750, raw_mean=0.1429, raw_var=0.0161, raw_max=0.9882, raw_diag=0.1939, raw_off=0.1343 | conf_mean=0.2104, conf_std=0.1351, p10=0.0631, p50=0.1872, p90=0.3881 | gate=none | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9427, base_topk=0.7367, base_diag=0.1529, base_off=0.1412 | `graph_logs/v2_1_E1-B_none_init-8/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_none_init-6 | gate_mode=none, gate_init=-6 | mse:0.3601382374763489, mae:0.4004872739315033 | ent=1.4933, topk=0.9633, overlap=0.9016, l1=0.0778, mean=0.1429, var=0.0170, max=0.9886, diag=0.1955, off=0.1341 | raw_ent=1.5356, raw_topk=0.9490, raw_overlap=0.9016, raw_l1=0.0750, raw_mean=0.1429, raw_var=0.0161, raw_max=0.9885, raw_diag=0.1941, raw_off=0.1343 | conf_mean=0.2109, conf_std=0.1355, p10=0.0630, p50=0.1877, p90=0.3887 | gate=none | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9427, base_topk=0.7368, base_diag=0.1529, base_off=0.1412 | `graph_logs/v2_1_E1-B_none_init-6/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_none_init-4 | gate_mode=none, gate_init=-4 | mse:0.36023077368736267, mae:0.40049442648887634 | ent=1.4949, topk=0.9630, overlap=0.9017, l1=0.0778, mean=0.1429, var=0.0169, max=0.9887, diag=0.1955, off=0.1341 | raw_ent=1.5374, raw_topk=0.9486, raw_overlap=0.9017, raw_l1=0.0750, raw_mean=0.1429, raw_var=0.0161, raw_max=0.9886, raw_diag=0.1941, raw_off=0.1343 | conf_mean=0.2099, conf_std=0.1351, p10=0.0629, p50=0.1869, p90=0.3882 | gate=none | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9427, base_topk=0.7368, base_diag=0.1529, base_off=0.1412 | `graph_logs/v2_1_E1-B_none_init-4/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_none_init-2 | gate_mode=none, gate_init=-2 | mse:0.3601436913013458, mae:0.4003433585166931 | ent=1.4607, topk=0.9661, overlap=0.8995, l1=0.0788, mean=0.1429, var=0.0188, max=0.9937, diag=0.1953, off=0.1341 | raw_ent=1.5006, raw_topk=0.9530, raw_overlap=0.8995, raw_l1=0.0763, raw_mean=0.1429, raw_var=0.0180, raw_max=0.9934, raw_diag=0.1936, raw_off=0.1344 | conf_mean=0.2289, conf_std=0.1500, p10=0.0658, p50=0.2014, p90=0.4309 | gate=none | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9427, base_topk=0.7368, base_diag=0.1529, base_off=0.1412 | `graph_logs/v2_1_E1-B_none_init-2/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_none_init0 | gate_mode=none, gate_init=0 | mse:0.3604859709739685, mae:0.400489866733551 | ent=1.4936, topk=0.9632, overlap=0.9016, l1=0.0779, mean=0.1429, var=0.0170, max=0.9885, diag=0.1955, off=0.1341 | raw_ent=1.5359, raw_topk=0.9490, raw_overlap=0.9016, raw_l1=0.0751, raw_mean=0.1429, raw_var=0.0161, raw_max=0.9885, raw_diag=0.1940, raw_off=0.1343 | conf_mean=0.2107, conf_std=0.1352, p10=0.0632, p50=0.1876, p90=0.3882 | gate=none | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9427, base_topk=0.7368, base_diag=0.1529, base_off=0.1412 | `graph_logs/v2_1_E1-B_none_init0/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_scalar_init-8 | gate_mode=scalar, gate_init=-8 | mse:0.3332720696926117, mae:0.36950764060020447 | ent=1.2281, topk=0.9553, overlap=0.8898, l1=0.1215, mean=0.1429, var=0.0372, max=0.9997, diag=0.0961, off=0.1506 | raw_ent=1.3013, raw_topk=0.9246, raw_overlap=0.8898, raw_l1=0.1145, raw_mean=0.1429, raw_var=0.0353, raw_max=0.9997, raw_diag=0.0948, raw_off=0.1509 | conf_mean=0.3313, conf_std=0.2803, p10=0.0300, p50=0.2526, p90=0.7921 | gate_mean=0.00036, std=0.00000, p10=0.00036, p50=0.00036, p90=0.00036, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00033, std=0.00000, p10=0.00033, p50=0.00033, p90=0.00033, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9459, base_topk=0.7146, base_diag=0.1428, base_off=0.1429 | `graph_logs/v2_1_E1-B_scalar_init-8/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_scalar_init-6 | gate_mode=scalar, gate_init=-6 | mse:0.3333948254585266, mae:0.36969560384750366 | ent=1.1826, topk=0.9607, overlap=0.8903, l1=0.1276, mean=0.1429, var=0.0399, max=0.9998, diag=0.0972, off=0.1505 | raw_ent=1.2485, raw_topk=0.9343, raw_overlap=0.8903, raw_l1=0.1216, raw_mean=0.1429, raw_var=0.0382, raw_max=0.9997, raw_diag=0.0962, raw_off=0.1506 | conf_mean=0.3584, conf_std=0.2817, p10=0.0404, p50=0.2928, p90=0.8222 | gate_mean=0.00265, std=0.00000, p10=0.00265, p50=0.00265, p90=0.00265, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9459, base_topk=0.7165, base_diag=0.1427, base_off=0.1429 | `graph_logs/v2_1_E1-B_scalar_init-6/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_scalar_init-4 | gate_mode=scalar, gate_init=-4 | mse:0.33352547883987427, mae:0.36996757984161377 | ent=1.3202, topk=0.9483, overlap=0.8906, l1=0.1098, mean=0.1429, var=0.0311, max=0.9998, diag=0.0998, off=0.1500 | raw_ent=1.3990, raw_topk=0.9135, raw_overlap=0.8906, raw_l1=0.1021, raw_mean=0.1429, raw_var=0.0291, raw_max=0.9997, raw_diag=0.0992, raw_off=0.1501 | conf_mean=0.2811, conf_std=0.2650, p10=0.0195, p50=0.1933, p90=0.6989 | gate_mean=0.01881, std=0.00000, p10=0.01881, p50=0.01881, p90=0.01881, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7235, base_diag=0.1430, base_off=0.1428 | `graph_logs/v2_1_E1-B_scalar_init-4/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_scalar_init-2 | gate_mode=scalar, gate_init=-2 | mse:0.33533811569213867, mae:0.3726387023925781 | ent=1.5594, topk=0.9333, overlap=0.9001, l1=0.0718, mean=0.1429, var=0.0161, max=0.9995, diag=0.1211, off=0.1465 | raw_ent=1.6529, raw_topk=0.8941, raw_overlap=0.9001, raw_l1=0.0638, raw_mean=0.1429, raw_var=0.0140, raw_max=0.9995, raw_diag=0.1201, raw_off=0.1466 | conf_mean=0.1506, conf_std=0.1611, p10=0.0194, p50=0.1023, p90=0.3250 | gate_mean=0.11438, std=0.00000, p10=0.11438, p50=0.11438, p90=0.11438, sat_low=0.00000, sat_high=0.00000 | alpha_mean=0.00033, std=0.00000, p10=0.00033, p50=0.00033, p90=0.00033, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9442, base_topk=0.7323, base_diag=0.1483, base_off=0.1419 | `graph_logs/v2_1_E1-B_scalar_init-2/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_scalar_init0 | gate_mode=scalar, gate_init=0 | mse:0.35227712988853455, mae:0.3937762975692749 | ent=1.5805, topk=0.9529, overlap=0.8912, l1=0.0692, mean=0.1429, var=0.0125, max=0.9405, diag=0.1602, off=0.1400 | raw_ent=1.6348, raw_topk=0.9343, raw_overlap=0.8912, raw_l1=0.0656, raw_mean=0.1429, raw_var=0.0114, raw_max=0.9403, raw_diag=0.1611, raw_off=0.1398 | conf_mean=0.1599, conf_std=0.0989, p10=0.0499, p50=0.1442, p90=0.2931 | gate_mean=0.47851, std=0.00000, p10=0.47851, p50=0.47851, p90=0.47851, sat_low=0.00000, sat_high=0.00000 | alpha_mean=0.00032, std=0.00000, p10=0.00032, p50=0.00032, p90=0.00032, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9427, base_topk=0.7372, base_diag=0.1527, base_off=0.1412 | `graph_logs/v2_1_E1-B_scalar_init0/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_per_var_init-8 | gate_mode=per_var, gate_init=-8 | mse:0.33322080969810486, mae:0.36938410997390747 | ent=1.2286, topk=0.9548, overlap=0.8880, l1=0.1194, mean=0.1429, var=0.0372, max=0.9997, diag=0.0936, off=0.1511 | raw_ent=1.3022, raw_topk=0.9236, raw_overlap=0.8880, raw_l1=0.1122, raw_mean=0.1429, raw_var=0.0353, raw_max=0.9997, raw_diag=0.0924, raw_off=0.1513 | conf_mean=0.3308, conf_std=0.2826, p10=0.0286, p50=0.2524, p90=0.7981 | gate_mean=0.00035, std=0.00002, p10=0.00032, p50=0.00035, p90=0.00036, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00033, std=0.00000, p10=0.00033, p50=0.00033, p90=0.00033, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9459, base_topk=0.7146, base_diag=0.1428, base_off=0.1429 | `graph_logs/v2_1_E1-B_per_var_init-8/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_per_var_init-6 | gate_mode=per_var, gate_init=-6 | mse:0.33286017179489136, mae:0.36932650208473206 | ent=1.1885, topk=0.9596, overlap=0.8899, l1=0.1251, mean=0.1429, var=0.0396, max=0.9998, diag=0.0948, off=0.1509 | raw_ent=1.2555, raw_topk=0.9324, raw_overlap=0.8899, raw_l1=0.1190, raw_mean=0.1429, raw_var=0.0378, raw_max=0.9997, raw_diag=0.0940, raw_off=0.1510 | conf_mean=0.3548, conf_std=0.2839, p10=0.0388, p50=0.2823, p90=0.8265 | gate_mean=0.00254, std=0.00013, p10=0.00239, p50=0.00256, p90=0.00267, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9459, base_topk=0.7164, base_diag=0.1427, base_off=0.1429 | `graph_logs/v2_1_E1-B_per_var_init-6/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_per_var_init-4 | gate_mode=per_var, gate_init=-4 | mse:0.33385148644447327, mae:0.37045443058013916 | ent=1.3282, topk=0.9474, overlap=0.8899, l1=0.1062, mean=0.1429, var=0.0305, max=0.9998, diag=0.0969, off=0.1505 | raw_ent=1.4071, raw_topk=0.9122, raw_overlap=0.8899, raw_l1=0.0985, raw_mean=0.1429, raw_var=0.0286, raw_max=0.9997, raw_diag=0.0966, raw_off=0.1506 | conf_mean=0.2769, conf_std=0.2664, p10=0.0178, p50=0.1856, p90=0.6941 | gate_mean=0.01812, std=0.00095, p10=0.01712, p50=0.01806, p90=0.01904, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00030, std=0.00000, p10=0.00030, p50=0.00030, p90=0.00030, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7235, base_diag=0.1430, base_off=0.1428 | `graph_logs/v2_1_E1-B_per_var_init-4/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_per_var_init-2 | gate_mode=per_var, gate_init=-2 | mse:0.3358902633190155, mae:0.37328892946243286 | ent=1.5347, topk=0.9382, overlap=0.9017, l1=0.0727, mean=0.1429, var=0.0175, max=0.9996, diag=0.1214, off=0.1464 | raw_ent=1.6228, raw_topk=0.9023, raw_overlap=0.9017, raw_l1=0.0656, raw_mean=0.1429, raw_var=0.0155, raw_max=0.9995, raw_diag=0.1198, raw_off=0.1467 | conf_mean=0.1661, conf_std=0.1664, p10=0.0253, p50=0.1158, p90=0.3545 | gate_mean=0.11412, std=0.00386, p10=0.11094, p50=0.11321, p90=0.11837, sat_low=0.00000, sat_high=0.00000 | alpha_mean=0.00033, std=0.00000, p10=0.00033, p50=0.00033, p90=0.00033, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9441, base_topk=0.7323, base_diag=0.1483, base_off=0.1419 | `graph_logs/v2_1_E1-B_per_var_init-2/stats.csv` | last log step |
| E1-B | DynamicGraphMixer_TCN_ETTm1_96_96_E1B_per_var_init0 | gate_mode=per_var, gate_init=0 | mse:0.35239940881729126, mae:0.3939664959907532 | ent=1.5651, topk=0.9553, overlap=0.8844, l1=0.0717, mean=0.1429, var=0.0133, max=0.8658, diag=0.1621, off=0.1396 | raw_ent=1.6192, raw_topk=0.9371, raw_overlap=0.8844, raw_l1=0.0682, raw_mean=0.1429, raw_var=0.0123, raw_max=0.8657, raw_diag=0.1627, raw_off=0.1396 | conf_mean=0.1679, conf_std=0.1035, p10=0.0509, p50=0.1499, p90=0.3127 | gate_mean=0.48035, std=0.00387, p10=0.47528, p50=0.48238, p90=0.48418, sat_low=0.00000, sat_high=0.00000 | alpha_mean=0.00032, std=0.00000, p10=0.00032, p50=0.00032, p90=0.00032, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9427, base_topk=0.7372, base_diag=0.1527, base_off=0.1412 | `graph_logs/v2_1_E1-B_per_var_init0/stats.csv` | last log step |
| E1-C | DynamicGraphMixer_TCN_ETTm1_96_96_E1C_scalar_scale1 | gate_mode=scalar, gate_init=-4, graph_scale=1 | mse:0.33419495820999146, mae:0.370343953371048 | ent=1.1859, topk=0.9627, overlap=0.9116, l1=0.1081, mean=0.1429, var=0.0395, max=0.9998, diag=0.1027, off=0.1495 | raw_ent=1.2444, raw_topk=0.9398, raw_overlap=0.9116, raw_l1=0.1031, raw_mean=0.1429, raw_var=0.0381, raw_max=0.9997, raw_diag=0.1023, raw_off=0.1496 | conf_mean=0.3605, conf_std=0.2807, p10=0.0441, p50=0.2949, p90=0.8149 | gate_mean=0.01899, std=0.00000, p10=0.01899, p50=0.01899, p90=0.01899, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00030, std=0.00000, p10=0.00030, p50=0.00030, p90=0.00030, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7235, base_diag=0.1431, base_off=0.1428 | `graph_logs/v2_1_E1-C_scalar_scale1/stats.csv` | last log step |
| E1-C | DynamicGraphMixer_TCN_ETTm1_96_96_E1C_scalar_scale2 | gate_mode=scalar, gate_init=-4, graph_scale=2 | mse:0.3337218761444092, mae:0.37048453092575073 | ent=1.2685, topk=0.9553, overlap=0.9118, l1=0.0970, mean=0.1429, var=0.0341, max=0.9998, diag=0.1050, off=0.1492 | raw_ent=1.3374, raw_topk=0.9264, raw_overlap=0.9118, raw_l1=0.0910, raw_mean=0.1429, raw_var=0.0324, raw_max=0.9997, raw_diag=0.1047, raw_off=0.1492 | conf_mean=0.3127, conf_std=0.2717, p10=0.0264, p50=0.2389, p90=0.7342 | gate_mean=0.01892, std=0.00000, p10=0.01892, p50=0.01892, p90=0.01892, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00030, std=0.00000, p10=0.00030, p50=0.00030, p90=0.00030, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7234, base_diag=0.1431, base_off=0.1428 | `graph_logs/v2_1_E1-C_scalar_scale2/stats.csv` | last log step |
| E1-C | DynamicGraphMixer_TCN_ETTm1_96_96_E1C_scalar_scale4 | gate_mode=scalar, gate_init=-4, graph_scale=4 | mse:0.33402562141418457, mae:0.3708430826663971 | ent=1.3005, topk=0.9508, overlap=0.9045, l1=0.1010, mean=0.1429, var=0.0323, max=0.9998, diag=0.0999, off=0.1500 | raw_ent=1.3757, raw_topk=0.9181, raw_overlap=0.9045, raw_l1=0.0941, raw_mean=0.1429, raw_var=0.0304, raw_max=0.9997, raw_diag=0.1004, raw_off=0.1499 | conf_mean=0.2931, conf_std=0.2678, p10=0.0216, p50=0.2127, p90=0.7089 | gate_mean=0.01884, std=0.00000, p10=0.01884, p50=0.01884, p90=0.01884, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00030, std=0.00000, p10=0.00030, p50=0.00030, p90=0.00030, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7235, base_diag=0.1431, base_off=0.1428 | `graph_logs/v2_1_E1-C_scalar_scale4/stats.csv` | last log step |
| E1-C | DynamicGraphMixer_TCN_ETTm1_96_96_E1C_scalar_scale8 | gate_mode=scalar, gate_init=-4, graph_scale=8 | mse:0.33392786979675293, mae:0.3700827360153198 | ent=1.2837, topk=0.9523, overlap=0.8931, l1=0.1112, mean=0.1429, var=0.0336, max=0.9997, diag=0.0982, off=0.1503 | raw_ent=1.3581, raw_topk=0.9205, raw_overlap=0.8931, raw_l1=0.1042, raw_mean=0.1429, raw_var=0.0317, raw_max=0.9997, raw_diag=0.0969, raw_off=0.1505 | conf_mean=0.3021, conf_std=0.2707, p10=0.0255, p50=0.2169, p90=0.7442 | gate_mean=0.01881, std=0.00000, p10=0.01881, p50=0.01881, p90=0.01881, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7236, base_diag=0.1430, base_off=0.1428 | `graph_logs/v2_1_E1-C_scalar_scale8/stats.csv` | last log step |
| E1-C | DynamicGraphMixer_TCN_ETTm1_96_96_E1C_scalar_scale16 | gate_mode=scalar, gate_init=-4, graph_scale=16 | mse:0.3343232572078705, mae:0.37049803137779236 | ent=1.3233, topk=0.9511, overlap=0.8856, l1=0.1183, mean=0.1429, var=0.0300, max=0.9997, diag=0.0937, off=0.1510 | raw_ent=1.3938, raw_topk=0.9188, raw_overlap=0.8856, raw_l1=0.1106, raw_mean=0.1429, raw_var=0.0283, raw_max=0.9996, raw_diag=0.0940, raw_off=0.1510 | conf_mean=0.2837, conf_std=0.2554, p10=0.0154, p50=0.2118, p90=0.6612 | gate_mean=0.01854, std=0.00000, p10=0.01854, p50=0.01854, p90=0.01854, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9455, base_topk=0.7235, base_diag=0.1427, base_off=0.1429 | `graph_logs/v2_1_E1-C_scalar_scale16/stats.csv` | last log step |

### Summary
- Best static gate config:
- Next step:

---

## v2.2 - Confidence gate (dynamic gate)

### Experiments
| Exp ID | Run ID | Config or Args | Metrics (MSE/MAE) | Adj stats (post) | Adj stats (raw) | Conf stats | Gate stats | Alpha stats | Base stats | Artifacts | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| E2-1 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-1_conf_scalar | gate_mode=conf_scalar, conf_metric=entropy, conf_source=pre_sparsify, mapping=power, gamma=1, warmup=0, graph_scale=8 | mse:0.33747756481170654, mae:0.37653905153274536 | ent=1.7004, topk=0.8982, overlap=0.8621, l1=0.0576, mean=0.1429, var=0.0081, max=0.9072, diag=0.1198, off=0.1467 | raw_ent=1.8207, raw_topk=0.8386, raw_overlap=0.8621, raw_l1=0.0430, raw_mean=0.1429, raw_var=0.0055, raw_max=0.8987, raw_diag=0.1214, raw_off=0.1464 | conf_mean=0.0644, conf_std=0.0820, p10=0.0039, p50=0.0373, p90=0.1566 | gate_mean=0.06436, std=0.05648, p10=0.01916, p50=0.04519, p90=0.13918, sat_low=0.56120, sat_high=0.00000 | alpha_mean=0.00033, std=0.00000, p10=0.00033, p50=0.00033, p90=0.00033, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9447, base_topk=0.7261, base_diag=0.1406, base_off=0.1432 | `graph_logs/v2_2_E2-1_conf_scalar/stats.csv` | last log step |
| E2-1 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-1_conf_per_var | gate_mode=conf_per_var, conf_metric=entropy, conf_source=pre_sparsify, mapping=power, gamma=1, warmup=0, graph_scale=8 | mse:0.3370150625705719, mae:0.37518247961997986 | ent=1.7308, topk=0.8785, overlap=0.8744, l1=0.0508, mean=0.1429, var=0.0067, max=0.8938, diag=0.1342, off=0.1443 | raw_ent=1.8781, raw_topk=0.7898, raw_overlap=0.8744, raw_l1=0.0280, raw_mean=0.1429, raw_var=0.0033, raw_max=0.8806, raw_diag=0.1340, raw_off=0.1443 | conf_mean=0.0349, conf_std=0.0607, p10=0.0027, p50=0.0131, p90=0.0866 | gate_mean=0.03486, std=0.06066, p10=0.00269, p50=0.01305, p90=0.08664, sat_low=0.81696, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9421, base_topk=0.7411, base_diag=0.1471, base_off=0.1421 | `graph_logs/v2_2_E2-1_conf_per_var/stats.csv` | last log step |
| E2-2 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-2_conf_per_var_power | conf_metric=entropy, gate_mode=conf_per_var, mapping=power, gamma=1, warmup=0, graph_scale=8 | mse:0.3367529809474945, mae:0.3750403821468353 | ent=1.7316, topk=0.8781, overlap=0.8771, l1=0.0502, mean=0.1429, var=0.0067, max=0.8840, diag=0.1342, off=0.1443 | raw_ent=1.8790, raw_topk=0.7893, raw_overlap=0.8771, raw_l1=0.0278, raw_mean=0.1429, raw_var=0.0032, raw_max=0.8702, raw_diag=0.1340, raw_off=0.1443 | conf_mean=0.0344, conf_std=0.0604, p10=0.0027, p50=0.0127, p90=0.0847 | gate_mean=0.03439, std=0.06042, p10=0.00265, p50=0.01273, p90=0.08471, sat_low=0.82199, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9421, base_topk=0.7412, base_diag=0.1471, base_off=0.1422 | `graph_logs/v2_2_E2-2_conf_per_var_power/stats.csv` | last log step |
| E2-2 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-2_conf_per_var_sigmoid | conf_metric=entropy, gate_mode=conf_per_var, mapping=sigmoid, w_init=4, b_init=-4, warmup=0, graph_scale=8 | mse:0.33661332726478577, mae:0.37358611822128296 | ent=1.6269, topk=0.9053, overlap=0.8513, l1=0.0701, mean=0.1429, var=0.0129, max=0.9974, diag=0.1196, off=0.1467 | raw_ent=1.7520, raw_topk=0.8433, raw_overlap=0.8513, raw_l1=0.0518, raw_mean=0.1429, raw_var=0.0099, raw_max=0.9970, raw_diag=0.1203, raw_off=0.1466 | conf_mean=0.0996, conf_std=0.1446, p10=0.0073, p50=0.0457, p90=0.2548 | gate_mean=0.03353, std=0.04369, p10=0.01852, p50=0.02153, p90=0.04832, sat_low=0.90458, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9429, base_topk=0.7392, base_diag=0.1456, base_off=0.1424 | `graph_logs/v2_2_E2-2_conf_per_var_sigmoid/stats.csv` | last log step |
| E2-3 |  | gate_conf_source in {pre_sparsify, post_sparsify} |  |  |  |  |  |  |  |  |  |
| E2-4 |  | gamma in {0.5, 1, 2, 4} |  |  |  |  |  |  |  |  |  |
| E2-5 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-5_conf_per_var_w2.0_b-2.0 | conf_metric=entropy, gate_mode=conf_per_var, mapping=sigmoid, w_init=2, b_init=-2, warmup=0, graph_scale=8 | mse:0.3384973406791687, mae:0.3772549629211426 | ent=1.7376, topk=0.8809, overlap=0.8722, l1=0.0525, mean=0.1429, var=0.0064, max=0.9423, diag=0.1321, off=0.1447 | raw_ent=1.8810, raw_topk=0.7975, raw_overlap=0.8722, raw_l1=0.0304, raw_mean=0.1429, raw_var=0.0031, raw_max=0.9357, raw_diag=0.1308, raw_off=0.1449 | conf_mean=0.0333, conf_std=0.0645, p10=0.0038, p50=0.0135, p90=0.0717 | gate_mean=0.12065, std=0.01746, p10=0.11392, p50=0.11588, p90=0.12817, sat_low=0.00000, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9435, base_topk=0.7364, base_diag=0.1482, base_off=0.1420 | `graph_logs/v2_2_E2-5_conf_per_var_w2.0_b-2.0/stats.csv` | last log step |
| E2-5 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-5_conf_per_var_w2.0_b-4.0 | conf_metric=entropy, gate_mode=conf_per_var, mapping=sigmoid, w_init=2, b_init=-4, warmup=0, graph_scale=8 | mse:0.34198445081710815, mae:0.3763316869735718 | ent=1.4146, topk=0.9341, overlap=0.8612, l1=0.0868, mean=0.1429, var=0.0263, max=0.9998, diag=0.1025, off=0.1496 | raw_ent=1.5151, raw_topk=0.8900, raw_overlap=0.8612, raw_l1=0.0744, raw_mean=0.1429, raw_var=0.0238, raw_max=0.9997, raw_diag=0.1011, raw_off=0.1498 | conf_mean=0.2214, conf_std=0.2509, p10=0.0186, p50=0.1181, p90=0.6339 | gate_mean=0.03400, std=0.02457, p10=0.01927, p50=0.02364, p90=0.06658, sat_low=0.85286, sat_high=0.00000 | alpha_mean=0.00031, std=0.00000, p10=0.00031, p50=0.00031, p90=0.00031, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9437, base_topk=0.7363, base_diag=0.1436, base_off=0.1427 | `graph_logs/v2_2_E2-5_conf_per_var_w2.0_b-4.0/stats.csv` | last log step |
| E2-5 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-5_conf_per_var_w4.0_b-2.0 | conf_metric=entropy, gate_mode=conf_per_var, mapping=sigmoid, w_init=4, b_init=-2, warmup=0, graph_scale=8 | mse:0.3398796617984772, mae:0.3785548210144043 | ent=1.7606, topk=0.8724, overlap=0.8730, l1=0.0464, mean=0.1429, var=0.0050, max=0.7615, diag=0.1386, off=0.1436 | raw_ent=1.9082, raw_topk=0.7825, raw_overlap=0.8730, raw_l1=0.0228, raw_mean=0.1429, raw_var=0.0017, raw_max=0.7395, raw_diag=0.1353, raw_off=0.1441 | conf_mean=0.0194, conf_std=0.0328, p10=0.0027, p50=0.0095, p90=0.0418 | gate_mean=0.12190, std=0.01828, p10=0.11429, p50=0.11705, p90=0.13097, sat_low=0.00000, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9434, base_topk=0.7370, base_diag=0.1485, base_off=0.1419 | `graph_logs/v2_2_E2-5_conf_per_var_w4.0_b-2.0/stats.csv` | last log step |
| E2-5 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-5_conf_per_var_w4.0_b-4.0 | conf_metric=entropy, gate_mode=conf_per_var, mapping=sigmoid, w_init=4, b_init=-4, warmup=0, graph_scale=8 | mse:0.33694663643836975, mae:0.3738158047199249 | ent=1.6301, topk=0.9036, overlap=0.8511, l1=0.0697, mean=0.1429, var=0.0127, max=0.9972, diag=0.1199, off=0.1467 | raw_ent=1.7567, raw_topk=0.8401, raw_overlap=0.8511, raw_l1=0.0508, raw_mean=0.1429, raw_var=0.0097, raw_max=0.9968, raw_diag=0.1206, raw_off=0.1466 | conf_mean=0.0972, conf_std=0.1442, p10=0.0066, p50=0.0427, p90=0.2497 | gate_mean=0.03324, std=0.04353, p10=0.01848, p50=0.02129, p90=0.04741, sat_low=0.90606, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9429, base_topk=0.7394, base_diag=0.1457, base_off=0.1424 | `graph_logs/v2_2_E2-5_conf_per_var_w4.0_b-4.0/stats.csv` | last log step |
| E2-6 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-6_conf_per_var_warmup0 | conf_metric=entropy, gate_mode=conf_per_var, mapping=sigmoid, w_init=4, b_init=-4, warmup=0, graph_scale=8 | mse:0.33734995126724243, mae:0.37532684206962585 | ent=1.7310, topk=0.8784, overlap=0.8776, l1=0.0501, mean=0.1429, var=0.0067, max=0.8840, diag=0.1345, off=0.1443 | raw_ent=1.8782, raw_topk=0.7899, raw_overlap=0.8776, raw_l1=0.0280, raw_mean=0.1429, raw_var=0.0033, raw_max=0.8699, raw_diag=0.1344, raw_off=0.1443 | conf_mean=0.0348, conf_std=0.0603, p10=0.0027, p50=0.0132, p90=0.0852 | gate_mean=0.03478, std=0.06029, p10=0.00266, p50=0.01321, p90=0.08522, sat_low=0.81920, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9421, base_topk=0.7412, base_diag=0.1471, base_off=0.1421 | `graph_logs/v2_2_E2-6_conf_per_var_warmup0/stats.csv` | last log step |
| E2-6 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-6_conf_per_var_warmup1 | conf_metric=entropy, gate_mode=conf_per_var, mapping=sigmoid, w_init=4, b_init=-4, warmup=1, graph_scale=8 | mse:0.3366050720214844, mae:0.3748432397842407 | ent=1.7310, topk=0.8769, overlap=0.8723, l1=0.0512, mean=0.1429, var=0.0067, max=0.8819, diag=0.1348, off=0.1442 | raw_ent=1.8789, raw_topk=0.7868, raw_overlap=0.8723, raw_l1=0.0275, raw_mean=0.1429, raw_var=0.0033, raw_max=0.8669, raw_diag=0.1340, raw_off=0.1443 | conf_mean=0.0344, conf_std=0.0612, p10=0.0020, p50=0.0123, p90=0.0872 | gate_mean=0.03445, std=0.06123, p10=0.00203, p50=0.01232, p90=0.08717, sat_low=0.81771, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9428, base_topk=0.7387, base_diag=0.1470, base_off=0.1422 | `graph_logs/v2_2_E2-6_conf_per_var_warmup1/stats.csv` | last log step |
| E2-6 | DynamicGraphMixer_TCN_ETTm1_96_96_E2-6_conf_per_var_warmup3 | conf_metric=entropy, gate_mode=conf_per_var, mapping=sigmoid, w_init=4, b_init=-4, warmup=3, graph_scale=8 | mse:0.34520217776298523, mae:0.38359764218330383 | ent=1.7371, topk=0.8892, overlap=0.8862, l1=0.0448, mean=0.1429, var=0.0061, max=0.6482, diag=0.1350, off=0.1442 | raw_ent=1.8767, raw_topk=0.8125, raw_overlap=0.8862, raw_l1=0.0270, raw_mean=0.1429, raw_var=0.0030, raw_max=0.6410, raw_diag=0.1320, raw_off=0.1447 | conf_mean=0.0356, conf_std=0.0404, p10=0.0071, p50=0.0222, p90=0.0780 | gate_mean=0.03559, std=0.04044, p10=0.00708, p50=0.02218, p90=0.07799, sat_low=0.79874, sat_high=0.00000 | alpha_mean=0.00033, std=0.00000, p10=0.00033, p50=0.00033, p90=0.00033, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9458, base_topk=0.7188, base_diag=0.1431, base_off=0.1428 | `graph_logs/v2_2_E2-6_conf_per_var_warmup3/stats.csv` | last log step |
| E2-Final |  | best 2-3 configs, 3 seeds | mean= , std= |  |  |  |  |  |  |  |  |

### Summary
- Best conf gate config: conf_per_var + sigmoid (w=4, b=-4), warmup=1, conf_source=pre_sparsify, graph_scale=8 -> mse=0.336605, mae=0.374843 (E2-6).
- Gate vs entropy trend: gate_mean ~= conf_mean (~0.034); low entropy => higher conf/gate, saturation mostly low (sat_low ~0.818).
- Decision: Use this config as the E3 baseline (conf gate + conf routing).

---

## v2.3 - Confidence routing + base regularization

### Experiments
| Exp ID | Run ID | Config or Args | Metrics (MSE/MAE) | Adj stats (post) | Adj stats (raw) | Conf stats | Gate stats | Alpha stats | Base stats | Artifacts | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| E3-1 | DynamicGraphMixer_TCN_ETTm1_96_96_E3-1_conf_per_var | gate_mode=conf_per_var, mapping=sigmoid (w=4, b=-4), warmup=1, graph_base_alpha_mode=static | mse:0.3360240161418915, mae:0.3727038502693176 | ent=1.6274, topk=0.9058, overlap=0.8518, l1=0.0697, mean=0.1429, var=0.0129, max=0.9967, diag=0.1209, off=0.1465 | raw_ent=1.7496, raw_topk=0.8461, raw_overlap=0.8518, raw_l1=0.0525, raw_mean=0.1429, raw_var=0.0100, raw_max=0.9963, raw_diag=0.1205, raw_off=0.1466 | conf_mean=0.1009, conf_std=0.1439, p10=0.0077, p50=0.0480, p90=0.2528 | gate_mean=0.03360, std=0.04341, p10=0.01860, p50=0.02178, p90=0.04791, sat_low=0.90885, sat_high=0.00000 | alpha_mean=0.00034, std=0.00000, p10=0.00034, p50=0.00034, p90=0.00034, sat_low=1.00000, sat_high=0.00000 | base_ent=1.9439, base_topk=0.7344, base_diag=0.1452, base_off=0.1425 | `graph_logs/v2_3_E3-1_conf_per_var_gate/stats.csv` | last log step |
| E3-2 | DynamicGraphMixer_TCN_ETTm1_96_96_E3-2_per_var | graph_base_alpha_mode=conf, gate_mode=per_var (init=-6) | mse:0.33322763442993164, mae:0.36963149905204773 | ent=1.2589, topk=0.9470, overlap=0.8944, l1=0.1140, mean=0.1429, var=0.0368, max=0.9871, diag=0.0948, off=0.1509 | raw_ent=1.3579, raw_topk=0.9074, raw_overlap=0.8944, raw_l1=0.1051, raw_mean=0.1429, raw_var=0.0340, raw_max=0.9847, raw_diag=0.0960, raw_off=0.1507 | conf_mean=0.3022, conf_std=0.2614, p10=0.0234, p50=0.2286, p90=0.7337 | gate_mean=0.00254, std=0.00013, p10=0.00231, p50=0.00256, p90=0.00276, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.17572, std=0.09911, p10=0.05965, p50=0.15935, p90=0.32394, sat_low=0.07422, sat_high=0.00000 | base_ent=1.9445, base_topk=0.7316, base_diag=0.1442, base_off=0.1426 | `graph_logs/v2_3_E3-2_conf_alpha_per_var/stats.csv` | last log step |
| E3-3 | DynamicGraphMixer_TCN_ETTm1_96_96_E3-3_conf_per_var | conf gate + conf alpha (gate=conf_per_var, alpha=conf) | mse:0.336034893989563, mae:0.3730504512786865 | ent=1.6385, topk=0.9082, overlap=0.8767, l1=0.0648, mean=0.1429, var=0.0122, max=0.9713, diag=0.1259, off=0.1457 | raw_ent=1.7717, raw_topk=0.8427, raw_overlap=0.8767, raw_l1=0.0483, raw_mean=0.1429, raw_var=0.0090, raw_max=0.9665, raw_diag=0.1269, raw_off=0.1455 | conf_mean=0.0895, conf_std=0.1174, p10=0.0130, p50=0.0491, p90=0.2100 | gate_mean=0.02975, std=0.03139, p10=0.01897, p50=0.02183, p90=0.04059, sat_low=0.93508, sat_high=0.00000 | alpha_mean=0.32452, std=0.08443, p10=0.20391, p50=0.34543, p90=0.41555, sat_low=0.00651, sat_high=0.00000 | base_ent=1.9426, base_topk=0.7418, base_diag=0.1433, base_off=0.1428 | `graph_logs/v2_3_E3-3_conf_per_var_conf_alpha/stats.csv` | last log step |
| E3-4 | DynamicGraphMixer_TCN_ETTm1_96_96_E3-4_conf_per_var | E3-3 + base_reg l2_to_identity (lambda=1e-3) | mse:0.3358883559703827, mae:0.3729158937931061 | ent=1.6359, topk=0.9090, overlap=0.8776, l1=0.0645, mean=0.1429, var=0.0124, max=0.9713, diag=0.1381, off=0.1437 | raw_ent=1.7686, raw_topk=0.8440, raw_overlap=0.8776, raw_l1=0.0486, raw_mean=0.1429, raw_var=0.0091, raw_max=0.9665, raw_diag=0.1331, raw_off=0.1445 | conf_mean=0.0911, conf_std=0.1184, p10=0.0139, p50=0.0503, p90=0.2139 | gate_mean=0.02997, std=0.03170, p10=0.01902, p50=0.02192, p90=0.04116, sat_low=0.93415, sat_high=0.00000 | alpha_mean=0.32200, std=0.08498, p10=0.20088, p50=0.34284, p90=0.41399, sat_low=0.00781, sat_high=0.00000 | base_ent=1.9412, base_topk=0.7431, base_diag=0.1620, base_off=0.1397 | `graph_logs/v2_3_E3-4_conf_per_var_reg0.001/stats.csv` | last log step |
| E3-5 | DynamicGraphMixer_TCN_ETTm1_96_96_E3-5_conf_per_var | E3-3 + base_reg l2_to_identity (lambda=1e-2) | mse:0.3358040153980255, mae:0.3726855218410492 | ent=1.6382, topk=0.9090, overlap=0.8754, l1=0.0644, mean=0.1429, var=0.0123, max=0.9717, diag=0.1447, off=0.1426 | raw_ent=1.7708, raw_topk=0.8442, raw_overlap=0.8754, raw_l1=0.0483, raw_mean=0.1429, raw_var=0.0090, raw_max=0.9669, raw_diag=0.1380, raw_off=0.1437 | conf_mean=0.0900, conf_std=0.1167, p10=0.0147, p50=0.0499, p90=0.2084 | gate_mean=0.02969, std=0.03108, p10=0.01907, p50=0.02187, p90=0.04028, sat_low=0.93545, sat_high=0.00000 | alpha_mean=0.32212, std=0.08369, p10=0.20276, p50=0.34284, p90=0.41195, sat_low=0.00651, sat_high=0.00000 | base_ent=1.9396, base_topk=0.7392, base_diag=0.1779, base_off=0.1370 | `graph_logs/v2_3_E3-5_conf_per_var_reg0.01/stats.csv` | last log step |

### Summary
- Best routing + reg config: E3-2 (conf alpha + static per_var gate init=-6), mse=0.33323, mae=0.36963.
- Interpretation notes: conf alpha alone beats conf gate variants; conf gate + conf alpha did not improve; base_reg (1e-3/1e-2) did not beat E3-3.

---

## v2.4 - Multi-scale stable graph fusion

### Experiments
| Exp ID | Run ID | Config or Args | Metrics (MSE/MAE) | Adj stats (post) | Adj stats (raw) | Conf stats | Gate stats | Alpha stats | Base stats | Artifacts | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| E4-1 | DynamicGraphMixer_TCN_ETTm1_96_96_E4-1 | A_stable=detrend, stable_window=16, graph_scale_stable=16 (base_source=stable_stream) | mse:0.3337724208831787, mae:0.3696741461753845 | ent=1.3678, topk=0.9553, overlap=0.8956, l1=0.0911, mean=0.1429, var=0.0276, max=0.9990, diag=0.1038, off=0.1494 | raw_ent=1.4431, raw_topk=0.9274, raw_overlap=0.8956, raw_l1=0.0849, raw_mean=0.1429, raw_var=0.0256, raw_max=0.9990, raw_diag=0.1043, raw_off=0.1493 | conf_mean=0.2584, conf_std=0.1785, p10=0.0795, p50=0.2143, p90=0.5178 | gate_mean=0.00259, std=0.00014, p10=0.00235, p50=0.00263, p90=0.00284, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.31001, std=0.11857, p10=0.14854, p50=0.31010, p90=0.46853, sat_low=0.00391, sat_high=0.00000 | base_ent=1.3721, base_topk=0.9729, base_diag=0.1441, base_off=0.1426 | `graph_logs/v2_4_E4-1/stats.csv` | last log step |
| E4-2 | DynamicGraphMixer_TCN_ETTm1_96_96_E4-2 | A_stable=detrend, stable_window=16, graph_scale_stable=32 (base_source=stable_stream) | mse:0.33530962467193604, mae:0.36985448002815247 | ent=1.3131, topk=0.9599, overlap=0.9009, l1=0.0871, mean=0.1429, var=0.0309, max=0.9994, diag=0.0972, off=0.1505 | raw_ent=1.3807, raw_topk=0.9351, raw_overlap=0.9009, raw_l1=0.0821, raw_mean=0.1429, raw_var=0.0291, raw_max=0.9994, raw_diag=0.0977, raw_off=0.1504 | conf_mean=0.2905, conf_std=0.2036, p10=0.0824, p50=0.2314, p90=0.6058 | gate_mean=0.00258, std=0.00014, p10=0.00234, p50=0.00259, p90=0.00284, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.26805, std=0.11770, p10=0.10940, p50=0.26561, p90=0.43489, sat_low=0.00130, sat_high=0.00000 | base_ent=1.0587, base_topk=0.9933, base_diag=0.1371, base_off=0.1438 | `graph_logs/v2_4_E4-2/stats.csv` | last log step |
| E4-3 | DynamicGraphMixer_TCN_ETTm1_96_96_E4-3_w8 | A_stable=detrend, stable_window=8, graph_scale_stable=16 (base_source=stable_stream) | mse:0.3338499069213867, mae:0.3697133958339691 | ent=1.3533, topk=0.9569, overlap=0.8920, l1=0.0923, mean=0.1429, var=0.0284, max=0.9988, diag=0.1028, off=0.1495 | raw_ent=1.4271, raw_topk=0.9298, raw_overlap=0.8920, raw_l1=0.0859, raw_mean=0.1429, raw_var=0.0263, raw_max=0.9988, raw_diag=0.1030, raw_off=0.1495 | conf_mean=0.2666, conf_std=0.1796, p10=0.0834, p50=0.2233, p90=0.5255 | gate_mean=0.00259, std=0.00014, p10=0.00236, p50=0.00262, p90=0.00284, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.30743, std=0.11853, p10=0.14429, p50=0.30760, p90=0.46582, sat_low=0.00521, sat_high=0.00000 | base_ent=1.2960, base_topk=0.9814, base_diag=0.1408, base_off=0.1432 | `graph_logs/v2_4_E4-3_w8/stats.csv` | last log step |
| E4-4 | DynamicGraphMixer_TCN_ETTm1_96_96_E4-4_w32 | A_stable=detrend, stable_window=32, graph_scale_stable=16 (base_source=stable_stream) | mse:0.33385053277015686, mae:0.3696640431880951 | ent=1.3977, topk=0.9484, overlap=0.8855, l1=0.0851, mean=0.1429, var=0.0268, max=0.9998, diag=0.1032, off=0.1495 | raw_ent=1.4964, raw_topk=0.9122, raw_overlap=0.8855, raw_l1=0.0759, raw_mean=0.1429, raw_var=0.0237, raw_max=0.9998, raw_diag=0.1059, raw_off=0.1490 | conf_mean=0.2310, conf_std=0.1268, p10=0.0991, p50=0.2119, p90=0.3833 | gate_mean=0.00262, std=0.00013, p10=0.00238, p50=0.00264, p90=0.00282, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.41242, std=0.10568, p10=0.24258, p50=0.43519, p90=0.52321, sat_low=0.00000, sat_high=0.00000 | base_ent=1.4551, base_topk=0.9689, base_diag=0.1287, base_off=0.1452 | `graph_logs/v2_4_E4-4_w32/stats.csv` | last log step |
| E4-5 | DynamicGraphMixer_TCN_ETTm1_96_96_E4-5_diff | A_stable=diff, stable_window=16, graph_scale_stable=16 (base_source=stable_stream) | mse:0.33523133397102356, mae:0.37011829018592834 | ent=1.3504, topk=0.9567, overlap=0.8903, l1=0.0942, mean=0.1429, var=0.0287, max=0.9982, diag=0.1048, off=0.1492 | raw_ent=1.4251, raw_topk=0.9291, raw_overlap=0.8903, raw_l1=0.0876, raw_mean=0.1429, raw_var=0.0266, raw_max=0.9981, raw_diag=0.1055, raw_off=0.1491 | conf_mean=0.2676, conf_std=0.1776, p10=0.0847, p50=0.2254, p90=0.5273 | gate_mean=0.00259, std=0.00013, p10=0.00237, p50=0.00261, p90=0.00283, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.30633, std=0.11833, p10=0.14080, p50=0.30889, p90=0.46568, sat_low=0.00000, sat_high=0.00000 | base_ent=1.3376, base_topk=0.9804, base_diag=0.1433, base_off=0.1428 | `graph_logs/v2_4_E4-5_diff/stats.csv` | last log step |
| E4-6 | DynamicGraphMixer_TCN_ETTm1_96_96_E4-6_share_encoder | A_stable=detrend, stable_window=16, graph_scale_stable=16, stable_share_encoder | mse:0.33335697650909424, mae:0.36994823813438416 | ent=1.2427, topk=0.9533, overlap=0.8866, l1=0.1165, mean=0.1429, var=0.0374, max=0.9992, diag=0.0954, off=0.1508 | raw_ent=1.3279, raw_topk=0.9203, raw_overlap=0.8866, raw_l1=0.1091, raw_mean=0.1429, raw_var=0.0351, raw_max=0.9991, raw_diag=0.0958, raw_off=0.1507 | conf_mean=0.3176, conf_std=0.2668, p10=0.0341, p50=0.2415, p90=0.7610 | gate_mean=0.00255, std=0.00013, p10=0.00232, p50=0.00258, p90=0.00275, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.17614, std=0.10049, p10=0.05558, p50=0.15998, p90=0.32558, sat_low=0.08073, sat_high=0.00000 | base_ent=1.8771, base_topk=0.8059, base_diag=0.1417, base_off=0.1431 | `graph_logs/v2_4_E4-6_share_encoder/stats.csv` | last log step |

### Summary
- Best stable fusion config: E4-6 (share encoder) is the best v2.4 variant so far (mse=0.33336), but still worse than E3-2 (mse=0.33323).
- Decision: v2.4 does not beat E3-2; stop v2.4 and move to v2.5 or run 3-seed confirmation on E3-2.

---

## v2.5 - Lag-aware graph mixing

### Experiments
| Exp ID | Run ID | Config or Args | Metrics (MSE/MAE) | Adj stats (post) | Adj stats (raw) | Conf stats | Gate stats | Alpha stats | Base stats | Artifacts | Notes |
| --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- | --- |
| E5-1 | DynamicGraphMixer_TCN_ETTm1_96_96_E5-1_lag2 | lag_mix_len=2, shared A_t, softmax weights | mse:0.33317238092422485, mae:0.369762659072876 | ent=1.3109, topk=0.9406, overlap=0.8961, l1=0.1056, mean=0.1429, var=0.0335, max=0.9852, diag=0.0874, off=0.1521 | raw_ent=1.4155, raw_topk=0.8964, raw_overlap=0.8961, raw_l1=0.0958, raw_mean=0.1429, raw_var=0.0305, raw_max=0.9826, raw_diag=0.0915, raw_off=0.1514 | conf_mean=0.2726, conf_std=0.2522, p10=0.0143, p50=0.1953, p90=0.6890 | gate_mean=0.00252, std=0.00012, p10=0.00233, p50=0.00251, p90=0.00274, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.19473, std=0.10836, p10=0.07025, p50=0.17195, p90=0.35556, sat_low=0.04688, sat_high=0.00000 | base_ent=1.9444, base_topk=0.7334, base_diag=0.1443, base_off=0.1426 | `graph_logs/v2_5_E5-1_lag2/stats.csv` | last log step |
| E5-2 | DynamicGraphMixer_TCN_ETTm1_96_96_E5-2_lag4 | lag_mix_len=4, shared A_t, softmax weights | mse:0.33329370617866516, mae:0.3698035180568695 | ent=1.3117, topk=0.9402, overlap=0.8996, l1=0.0997, mean=0.1429, var=0.0333, max=0.9832, diag=0.0766, off=0.1539 | raw_ent=1.4157, raw_topk=0.8957, raw_overlap=0.8996, raw_l1=0.0900, raw_mean=0.1429, raw_var=0.0303, raw_max=0.9802, raw_diag=0.0847, raw_off=0.1525 | conf_mean=0.2725, conf_std=0.2534, p10=0.0117, p50=0.1977, p90=0.6973 | gate_mean=0.00251, std=0.00012, p10=0.00236, p50=0.00247, p90=0.00273, sat_low=1.00000, sat_high=0.00000 | alpha_mean=0.19670, std=0.11137, p10=0.06876, p50=0.17402, p90=0.36988, sat_low=0.02995, sat_high=0.00000 | base_ent=1.9445, base_topk=0.7338, base_diag=0.1431, base_off=0.1428 | `graph_logs/v2_5_E5-2_lag4/stats.csv` | last log step |

### Summary
- Best lag-aware config: E5-1 (lag_mix_len=2) with mse=0.33317, mae=0.36976 (slightly better than E3-2).
- Decision: Run 3-seed confirmation for E5-1; skip E5-2 unless E5-1 is stable.

---

